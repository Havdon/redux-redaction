{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap a3e24ff1e33c415cee22","webpack:///./src/index.js","webpack:///./src/createRedaction.js","webpack:///./src/utils.js","webpack:///./src/redaction.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"redux-redaction\"] = factory();\n\telse\n\t\troot[\"redux-redaction\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap a3e24ff1e33c415cee22\n **/","\n\nimport createRedaction from './createRedaction';\nimport redaction, { Redaction } from './redaction';\n\nexport {\n    createRedaction,\n    redaction,\n    Redaction\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","import { pathMap } from './utils'\nimport { Redaction } from './redaction'\n\nexport default createRedaction;\n\nconst isFunction = f => (Object.prototype.toString.call(f) === '[object Function]');\n\nfunction createRedaction(mod, parentName) {\n    \n    var redaction = Object.keys(mod).reduce((prev, key) => {\n        if (key === 'initialState') {\n            return prev;\n        }\n        \n        const obj = mod[key];\n        const name = parentName ? `${parentName}.${key}` : key;\n        if (isFunction(obj)) {\n            return {\n                ...prev,\n                reducers: {...prev.reducers, [name]: obj},\n                actions: {...prev.actions, [key]: (...args) => {\n                   return {type: name, payload: (args.length === 1 ? args[0] : args )};\n               }}\n            }\n        }\n        \n        if (obj instanceof Redaction) {\n            return {\n                ...prev,\n                reducers: {...prev.reducers, [name]: ::obj.handleReduce},\n                actions: {...prev.actions, [key]: (...args) => {\n                   let action = obj.getAction(...args) || {};\n                   if (isFunction(action)) {\n                       // Pass functions through so that thunks, etc still work.\n                       return action;\n                   }\n                   else if(typeof action === 'string') {\n                       action = {\n                           payload: action\n                       }\n                   }\n                   return {\n                       ...action,\n                       type: name\n                    };\n               }}\n            }\n        }\n        \n        // Any object with initialState is assumed to be a redaction module.\n        if (typeof obj.initialState !== 'undefined') {\n            if (typeof prev.initialState !== 'object') {\n                throw new Error(`Redaction ${name} cannot have subredactions if the initial state is not an object.`);\n            }\n            const subRedaction = createRedaction(obj, name);\n            return {\n                ...prev,\n                initialState: {\n                    ...prev.initialState,\n                    [key]: subRedaction.initialState\n                },\n                reducers: {...prev.reducers, ...subRedaction.reducers},\n                actions: {...prev.actions,\n                    [key]: subRedaction.actions    \n                }\n            }\n        }\n        return prev;\n        \n    }, {initialState: typeof mod.initialState !== 'undefined' ? mod.initialState : {}})\n    \n    redaction.reducer = (state = redaction.initialState, action = {}) => {\n        const func = redaction.reducers[action.type];\n        if (func) {\n            \n            const split = action.type.split('.');\n            if (split.length == 1) return func(state, action);\n            split.pop();\n            return pathMap(state, split, (subState) => {\n                return func(subState, action)\n            })\n        }\n        else {\n            return state;\n        }\n    };\n    return redaction;\n}\n\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/createRedaction.js\n **/","export const pathMap = (obj, path, cb) => {\n    if (typeof path === 'string') path = path.split('.');\n    path = [...path];\n    const key = path.shift();\n    if (typeof obj[key] !== 'undefined') {\n        if (path.length > 0) {\n            return {\n                ...obj,\n                [key]: pathMap(obj[key], path, cb)\n            };\n        }\n        else {\n            return {\n                ...obj,\n                [key]: cb(obj[key])\n            };\n        }\n    }\n    return obj;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils.js\n **/","export class Redaction {\n    constructor(actionFn) {\n        this.actionFn = actionFn;\n        this.name = null;\n    }\n    \n    reduce(cb) {\n        this.reduceCb = cb;\n        return this;\n    }\n    \n    onError(cb) {\n        this.onErrorCb = cb;\n        return this;\n    }\n    \n    onPending(cb) {\n        this.onPendingCb = cb;\n        return this;\n    }\n    \n    getAction(...args) {\n        if (typeof this.actionFn === 'function')\n            return this.actionFn(...args);\n        else\n            return this.actionFn;\n    }\n    \n    \n    \n    handleReduce(state, action = {}) {\n        if (Redaction.isPending(action)) {\n            if (this.onPendingCb)\n                return this.onPendingCb(state, action);\n        } else if(Redaction.isError(action)) {\n            if (this.onErrorCb)\n                return this.onErrorCb(state, action);\n        } else if (this.reduceCb) {\n            return this.reduceCb(state, action);\n        }\n       return state;\n    }\n    \n    static isPending(action) {\n        return action.pending;\n    }\n    \n    static isError(action) {\n        return action.error;\n    }\n}\n\n\n\n\n\nconst redaction = action => new Redaction(action);\n\n\nexport default redaction;\n\n\n/** WEBPACK FOOTER **\n ** ./src/redaction.js\n **/"],"sourceRoot":""}